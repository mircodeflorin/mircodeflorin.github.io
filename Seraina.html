<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meine 7-Tage Challenge</title>
    <style>
        :root {
            --primary: #7e57c2;
            --primary-light: #b085f5;
            --primary-dark: #4d2c91;
            --background: #f5f5f7;
            --card: #ffffff;
            --text: #333333;
            --success: #66bb6a;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .container {
            background-color: var(--card);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        header h1 {
            color: var(--primary-dark);
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        header p {
            color: var(--text);
            font-size: 16px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        h2 {
            color: var(--primary-dark);
            font-size: 22px;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 8px;
        }
        
        h3 {
            color: var(--primary);
            font-size: 18px;
            margin: 15px 0 10px;
        }
        
        .challenge-box {
            background-color: #f8f4ff;
            border: 1px solid var(--primary-light);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .challenge-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .challenge-desc {
            font-size: 14px;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        
        input[type="text"], 
        input[type="time"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 10px;
            font-family: inherit;
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: block;
            margin: 20px auto;
            width: 100%;
            max-width: 300px;
        }
        
        button:hover {
            background-color: var(--primary-dark);
        }
        
        .tracker {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .day {
            width: 75px;
            height: 75px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            background-color: white;
        }
        
        .day-number {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .day-label {
            font-size: 14px;
            color: var(--text);
        }
        
        .day.completed {
            background-color: var(--primary);
        }
        
        .day.completed .day-number,
        .day.completed .day-label {
            color: white;
        }
        
        .mood-selector {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
        }
        
        .mood-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .mood-emoji {
            font-size: 28px;
            margin-bottom: 5px;
            transition: transform 0.2s;
        }
        
        .mood-option:hover .mood-emoji {
            transform: scale(1.2);
        }
        
        .mood-label {
            font-size: 12px;
        }
        
        .mood-option.selected .mood-emoji {
            transform: scale(1.2);
        }
        
        .mood-option.selected .mood-label {
            font-weight: bold;
            color: var(--primary);
        }
        
        .daily-log {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-top: 25px;
        }
        
        .daily-log h3 {
            margin-top: 0;
        }
        
        .log-entry {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary);
        }
        
        .log-date {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .log-mood {
            margin-bottom: 10px;
        }
        
        .log-challenges {
            margin-bottom: 10px;
        }
        
        .log-note {
            font-style: italic;
            font-size: 14px;
            border-top: 1px solid #eee;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .selection-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }
        
        .selection-option {
            padding: 8px 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .selection-option:hover {
            background-color: #e0e0e0;
        }
        
        .selection-option.selected {
            background-color: var(--primary);
            color: white;
        }
        
        .reward-section {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 10px;
            border: 1px dashed #ffc107;
            margin: 20px 0;
        }
        
        .success-message {
            display: none;
            background-color: var(--success);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            flex: 1;
            text-align: center;
            color: var(--text);
            font-weight: bold;
            position: relative;
            margin: 0;
            width: auto;
        }
        
        .tab-button.active {
            color: var(--primary);
        }
        
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .goal-progress {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            width: 0%;
            transition: width 0.3s;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            h2 {
                font-size: 20px;
            }
            
            .tracker {
                justify-content: center;
            }
            
            .day {
                width: 60px;
                height: 60px;
                margin: 5px;
            }
            
            .mood-emoji {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Meine 7-Tage Challenge</h1>
            <p>Ein kleines Experiment für eine Woche - du entscheidest, was dir gut tut!</p>
        </header>
        
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('setup')">Mein Plan</button>
                <button class="tab-button" onclick="showTab('daily')">Täglicher Check-in</button>
                <button class="tab-button" onclick="showTab('progress')">Fortschritt</button>
            </div>
            
            <div id="setup" class="tab-content active">
                <div class="section">
                    <h2>Meine Challenge auswählen</h2>
                    <p>Wähle 2-3 kleine Herausforderungen, die du für 7 Tage ausprobieren willst:</p>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Screen-Time Challenge</div>
                        <div class="challenge-desc">Vor dem Schlafengehen bildschirmfreie Zeit einplanen</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge1" onchange="saveSelectedChallenges()">
                            <label for="challenge1">Ich wähle diese Challenge</label>
                        </div>
                        <div class="selection-options" id="screen-time-options">
                            <div class="selection-option" onclick="selectOption(this, 'screen-time')">30 Min.</div>
                            <div class="selection-option" onclick="selectOption(this, 'screen-time')">45 Min.</div>
                            <div class="selection-option" onclick="selectOption(this, 'screen-time')">60 Min.</div>
                        </div>
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Schlaf-Reset Challenge</div>
                        <div class="challenge-desc">Jeden Tag zu einer festgelegten Zeit ins Bett gehen</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge2" onchange="saveSelectedChallenges()">
                            <label for="challenge2">Ich wähle diese Challenge</label>
                        </div>
                        <label for="bedtime">Meine Schlafenszeit:</label>
                        <input type="time" id="bedtime" onchange="saveSelectedChallenges()">
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Morgen-Kickstart Challenge</div>
                        <div class="challenge-desc">Jeden Tag bis zu einer bestimmten Zeit aufstehen</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge3" onchange="saveSelectedChallenges()">
                            <label for="challenge3">Ich wähle diese Challenge</label>
                        </div>
                        <div class="selection-options" id="wakeup-options">
                            <div class="selection-option" onclick="selectOption(this, 'wakeup')">11:00 Uhr</div>
                            <div class="selection-option" onclick="selectOption(this, 'wakeup')">10:30 Uhr</div>
                            <div class="selection-option" onclick="selectOption(this, 'wakeup')">10:00 Uhr</div>
                        </div>
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Mini-Move Challenge</div>
                        <div class="challenge-desc">Ein wenig tägliche Bewegung für Körper und Geist</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge4" onchange="saveSelectedChallenges()">
                            <label for="challenge4">Ich wähle diese Challenge</label>
                        </div>
                        <div class="selection-options" id="movement-options">
                            <div class="selection-option" onclick="selectOption(this, 'movement')">5 Min. Dehnen</div>
                            <div class="selection-option" onclick="selectOption(this, 'movement')">Kurzer Spaziergang</div>
                            <div class="selection-option" onclick="selectOption(this, 'movement')">Etwas Tanzen</div>
                        </div>
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Familien-Frieden Challenge</div>
                        <div class="challenge-desc">Kurze positive Interaktionen mit der Familie</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge5" onchange="saveSelectedChallenges()">
                            <label for="challenge5">Ich wähle diese Challenge</label>
                        </div>
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Selbstfürsorge Challenge</div>
                        <div class="challenge-desc">Bewusst etwas tun, das dir gut tut</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge6" onchange="saveSelectedChallenges()">
                            <label for="challenge6">Ich wähle diese Challenge</label>
                        </div>
                        <textarea id="selfcare-ideas" placeholder="Was tut dir gut? (z.B. Lieblingsmusik hören, ein Bad nehmen...)" onchange="saveSelectedChallenges()"></textarea>
                    </div>
                    
                    <div class="challenge-box">
                        <div class="challenge-title">Eigene Challenge</div>
                        <div class="challenge-desc">Etwas, das du dir selbst vornehmen möchtest</div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="challenge7" onchange="saveSelectedChallenges()">
                            <label for="challenge7">Ich wähle diese Challenge</label>
                        </div>
                        <textarea id="custom-challenge" placeholder="Was möchtest du tun?" onchange="saveSelectedChallenges()"></textarea>
                    </div>
                </div>
                
                <div class="reward-section">
                    <h2>Meine Belohnung</h2>
                    <p>Wenn ich mindestens 5 von 7 Tagen meine Challenges geschafft habe, belohne ich mich mit:</p>
                    <textarea id="reward" placeholder="Etwas, worauf ich mich freuen kann..." onchange="saveSelectedChallenges()"></textarea>
                </div>
                
                <div class="section">
                    <h2>Meine Vereinbarung</h2>
                    <p>Ich probiere diese Challenge für 7 Tage aus. Danach entscheide ich selbst, ob ich weitermachen möchte.</p>
                    <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                        <div style="text-align: center;">
                            <p>Startdatum:</p>
                            <input type="date" id="start-date" onchange="saveSelectedChallenges()">
                        </div>
                        <div style="text-align: center;">
                            <p>Mein Name:</p>
                            <input type="text" id="name" placeholder="Name" onchange="saveSelectedChallenges()">
                        </div>
                    </div>
                </div>
                
                <button onclick="savePlan()">Meinen Plan speichern</button>
                <div id="save-success" class="success-message">Dein Plan wurde gespeichert! Jetzt kannst du zum täglichen Check-in wechseln.</div>
            </div>
            
            <div id="daily" class="tab-content">
                <div class="section">
                    <h2>Mein täglicher Check-in</h2>
                    <p>Hier kannst du festhalten, wie dein Tag war und was du geschafft hast.</p>
                    
                    <label for="log-date">Datum:</label>
                    <input type="date" id="log-date">
                    
                    <h3>Wie fühlst du dich heute?</h3>
                    <div class="mood-selector">
                        <div class="mood-option" onclick="selectMood(1)">
                            <div class="mood-emoji">😢</div>
                            <div class="mood-label">Sehr schlecht</div>
                        </div>
                        <div class="mood-option" onclick="selectMood(2)">
                            <div class="mood-emoji">😕</div>
                            <div class="mood-label">Schlecht</div>
                        </div>
                        <div class="mood-option" onclick="selectMood(3)">
                            <div class="mood-emoji">😐</div>
                            <div class="mood-label">Neutral</div>
                        </div>
                        <div class="mood-option" onclick="selectMood(4)">
                            <div class="mood-emoji">🙂</div>
                            <div class="mood-label">Gut</div>
                        </div>
                        <div class="mood-option" onclick="selectMood(5)">
                            <div class="mood-emoji">😄</div>
                            <div class="mood-label">Sehr gut</div>
                        </div>
                    </div>
                    
                    <h3>Was hast du heute geschafft?</h3>
                    <div id="daily-challenges">
                        <!-- Wird dynamisch befüllt basierend auf ausgewählten Challenges -->
                    </div>
                    
                    <h3>Notiz für heute</h3>
                    <textarea id="daily-note" placeholder="Was möchtest du zu heute festhalten? Was hat geklappt? Was war schwierig?"></textarea>
                    
                    <button onclick="saveDaily()">Eintrag speichern</button>
                    <div id="daily-success" class="success-message">Dein Eintrag wurde gespeichert! Super gemacht!</div>
                </div>
                
                <div class="section">
                    <h2>Tägliche Einträge</h2>
                    <div id="log-entries">
                        <!-- Wird dynamisch befüllt mit den täglichen Einträgen -->
                    </div>
                </div>
            </div>
            
            <div id="progress" class="tab-content">
                <div class="section">
                    <h2>Mein 7-Tage Fortschritt</h2>
                    <p>Hier siehst du, wie weit du schon gekommen bist:</p>
                    
                    <div class="tracker">
                        <div class="day" onclick="toggleDay(1)">
                            <div class="day-number">1</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(2)">
                            <div class="day-number">2</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(3)">
                            <div class="day-number">3</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(4)">
                            <div class="day-number">4</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(5)">
                            <div class="day-number">5</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(6)">
                            <div class="day-number">6</div>
                            <div class="day-label">Tag</div>
                        </div>
                        <div class="day" onclick="toggleDay(7)">
                            <div class="day-number">7</div>
                            <div class="day-label">Tag</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 20px;">Dein Ziel: 5 von 7 Tagen</h3>
                    <div class="goal-progress">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <p id="progress-text">Du hast bisher 0 von 7 Tagen geschafft</p>
                    
                    <h3>Meine Stimmung im Verlauf</h3>
                    <div id="mood-chart" style="height: 150px; margin-top: 15px; display: flex; align-items: flex-end;">
                        <!-- Wird dynamisch befüllt -->
                    </div>
                    
                    <div class="reward-section" style="margin-top: 30px;">
                        <h3>Meine Belohnung:</h3>
                        <p id="reward-text">Wird geladen...</p>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Meine Erkenntnisse</h2>
                    <p>Nach den 7 Tagen: Was hat dir geholfen? Was möchtest du beibehalten?</p>
                    <textarea id="reflections" placeholder="Deine Gedanken zur Challenge..." onchange="saveReflections()"></textarea>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Globale Variablen
        let selectedMood = 0;
        let completedDays = [];
        
        // Seite initialisieren
        window.onload = function() {
            setToday();
            loadSelectedChallenges();
            updateDailyCheckboxes();
            loadLogEntries();
            updateProgressView();
        }
        
        // Aktuelles Datum setzen
        function setToday() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('log-date').value = today;
            
            // Wenn kein Startdatum gesetzt, heute als Standard setzen
            if (!document.getElementById('start-date').value) {
                document.getElementById('start-date').value = today;
            }
        }
        
        // Tab-Wechsel
        function showTab(tabId) {
            // Alle Tabs verstecken
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Alle Tab-Buttons deaktivieren
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Gewählten Tab anzeigen
            document.getElementById(tabId).classList.add('active');
            
            // Tab-Button aktivieren
            document.querySelectorAll('.tab-button').forEach(button => {
                if (button.getAttribute('onclick').includes(tabId)) {
                    button.classList.add('active');
                }
            });
            
            // Besondere Aktionen für bestimmte Tabs
            if (tabId === 'daily') {
                updateDailyCheckboxes();
            } else if (tabId === 'progress') {
                updateProgressView();
            }
        }
        
        // Option auswählen (für die verschiedenen Selectors)
        function selectOption(element, optionGroup) {
            // Alle Optionen in der Gruppe deselektieren
            const options = document.getElementById(optionGroup + '-options').getElementsByClassName('selection-option');
            for (let i = 0; i < options.length; i++) {
                options[i].classList.remove('selected');
            }
            
            // Gewählte Option selektieren
            element.classList.add('selected');
            
            // Speichern
            saveSelectedChallenges();
        }
        
        // Stimmung auswählen
        function selectMood(level) {
            selectedMood = level;
            
            // Alle Stimmungen deselektieren
            document.querySelectorAll('.mood-option').forEach((option, index) => {
                option.classList.remove('selected');
            });
            
            // Gewählte Stimmung selektieren
            document.querySelectorAll('.mood-option')[level-1].classList.add('selected');
        }
        
        // Ausgewählte Challenges speichern
        function saveSelectedChallenges() {
            const challenges = {
                challenge1: document.getElementById('challenge1').checked,
                challenge2: document.getElementById('challenge2').checked,
                challenge3: document.getElementById('challenge3').checked,
                challenge4: document.getElementById('challenge4').checked,
                challenge5: document.getElementById('challenge5').checked,
                challenge6: document.getElementById('challenge6').checked,
                challenge7: document.getElementById('challenge7').checked,
                bedtime: document.getElementById('bedtime').value,
                selfcareIdeas: document.getElementById('selfcare-ideas').value,
                customChallenge: document.getElementById('custom-challenge').value,
                reward: document.getElementById('reward').value,
                startDate: document.getElementById('start-date').value,
                name: document.getElementById('name').value
            };
            
            // Ausgewählte Optionen speichern
            document.querySelectorAll('.selection-options').forEach(selector => {
                const selected = selector.querySelector('.selected');
                if (selected) {
                    const selectorId = selector.id.split('-options')[0];
                    challenges[selectorId + 'Selected'] = selected.innerText;
                }
            });
            
            localStorage.setItem('challenges', JSON.stringify(challenges));
        }
        
        // Plan speichern und bestätigen
        function savePlan() {
            saveSelectedChallenges();
            
            // Erfolgsbenachrichtigung anzeigen
            const successMsg = document.getElementById('save-success');
            successMsg.style.display = 'block';
            
            // Nach 3 Sekunden zum täglichen Check-in wechseln
            setTimeout(() => {
                showTab('daily');
                successMsg.style.display = 'none';
            }, 3000);
        }
        
        // Ausgewählte Challenges laden
        function loadSelectedChallenges() {
            const savedChallenges = localStorage.getItem('challenges');
            if (savedChallenges) {
                const challenges = JSON.parse(savedChallenges);
                
                // Checkboxes
                document.getElementById('challenge1').checked = challenges.challenge1;
                document.getElementById('challenge2').checked = challenges.challenge2;
                document.getElementById('challenge3').checked = challenges.challenge3;
                document.getElementById('challenge4').checked = challenges.challenge4;
                document.getElementById('challenge5').checked = challenges.challenge5;
                document.getElementById('challenge6').checked = challenges.challenge6;
                document.getElementById('challenge7').checked = challenges.challenge7;
                
                // Textfelder
                document.getElementById('bedtime').value = challenges.bedtime;
                document.getElementById('selfcare-ideas').value = challenges.selfcareIdeas;
                document.getElementById('custom-challenge').value = challenges.customChallenge;
                document.getElementById('reward').value = challenges.reward;
                document.getElementById('start-date').value = challenges.startDate;
                document.getElementById('name').value = challenges.name;
                
                // Selektierte Optionen
                if (challenges.screenTimeSelected) {
                    selectOptionByText('screen-time-options', challenges.screenTimeSelected);
                }
                if (challenges.wakeupSelected) {
                    selectOptionByText('wakeup-options', challenges.wakeupSelected);
                }
                if (challenges.movementSelected) {
                    selectOptionByText('movement-options', challenges.movementSelected);
                }
                
                // Belohnungstext aktualisieren
                document.getElementById('reward-text').innerText = challenges.reward || "Keine Belohnung festgelegt";
            }
        }
        
        // Option nach Text auswählen
        function selectOptionByText(optionsId, text) {
            const options = document.getElementById(optionsId).getElementsByClassName('selection-option');
            for (let i = 0; i < options.length; i++) {
                if (options[i].innerText === text) {
                    options[i].classList.add('selected');
                    break;
                }
            }
        }
        
        // Tägliche Checkboxen aktualisieren basierend auf ausgewählten Challenges
        function updateDailyCheckboxes() {
            const savedChallenges = localStorage.getItem('challenges');
            if (!savedChallenges) return;
            
            const challenges = JSON.parse(savedChallenges);
            const dailyChallengesDiv = document.getElementById('daily-challenges');
            dailyChallengesDiv.innerHTML = '';
            
            // Für jede ausgewählte Challenge eine Checkbox erstellen
            if (challenges.challenge1) {
                addDailyCheckbox('daily-c1', 'Screen-Time: ' + (challenges.screenTimeSelected || '30 Min.') + ' vor dem Schlafen keine Bildschirme');
            }
            if (challenges.challenge2) {
                addDailyCheckbox('daily-c2', 'Bis ' + (challenges.bedtime || '22:00') + ' Uhr ins Bett gegangen');
            }
            if (challenges.challenge3) {
                addDailyCheckbox('daily-c3', 'Bis ' + (challenges.wakeupSelected || '11:00 Uhr') + ' aufgestanden');
            }
            if (challenges.challenge4) {
                addDailyCheckbox('daily-c4', 'Bewegung: ' + (challenges.movementSelected || '5 Min. Bewegung'));
            }
            if (challenges.challenge5) {
                addDailyCheckbox('daily-c5', 'Positives Gespräch mit einem Familienmitglied');
            }
            if (challenges.challenge6) {
                addDailyCheckbox('daily-c6', 'Selbstfürsorge: Etwas getan, das mir gut tut');
            }
            if (challenges.challenge7 && challenges.customChallenge) {
                addDailyCheckbox('daily-c7', 'Eigene Challenge: ' + challenges.customChallenge);
            }
        }
        
        // Checkbox für tägliches Tracking hinzufügen
        function addDailyCheckbox(id, label) {
            const dailyChallengesDiv = document.getElementById('daily-challenges');
            
            const checkboxItem = document.createElement('div');
            checkboxItem.className = 'checkbox-item';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = id;
            
            const labelElement = document.createElement('label');
            labelElement.htmlFor = id;
            labelElement.innerText = label;
            
            checkboxItem.appendChild(checkbox);
            checkboxItem.appendChild(labelElement);
            dailyChallengesDiv.appendChild(checkboxItem);
        }
        
        // Täglichen Eintrag speichern
        function saveDaily() {
            if (selectedMood === 0) {
                alert('Bitte wähle eine Stimmung aus.');
                return;
            }
            
            const date = document.getElementById('log-date').value;
            if (!date) {
                alert('Bitte wähle ein Datum aus.');
                return;
            }
            
            // Erledige Challenges sammeln
            const completedChallenges = [];
            document.querySelectorAll('#daily-challenges input[type="checkbox"]').forEach(checkbox => {
                if (checkbox.checked) {
                    completedChallenges.push({
                        id: checkbox.id,
                        label: checkbox.nextElementSibling.innerText
                    });
                }
            });
            
            const note = document.getElementById('daily-note').value;
            
            // Eintrag erstellen
            const entry = {
                date: date,
                mood: selectedMood,
                completedChallenges: completedChallenges,
                note: note
            };
            
            // Einträge laden und neuen hinzufügen
            let entries = [];
            const savedEntries = localStorage.getItem('dailyEntries');
            if (savedEntries) {
                entries = JSON.parse(savedEntries);
                
                // Prüfen, ob für dieses Datum bereits ein Eintrag existiert
                const existingEntryIndex = entries.findIndex(e => e.date === date);
                if (existingEntryIndex >= 0) {
                    // Bestehenden Eintrag überschreiben
                    entries[existingEntryIndex] = entry;
                } else {
                    // Neuen Eintrag hinzufügen
                    entries.push(entry);
                }
            } else {
                entries.push(entry);
            }
            
            // Speichern
            localStorage.setItem('dailyEntries', JSON.stringify(entries));
            
            // Einträge neu laden und anzeigen
            loadLogEntries();
            
            // Fortschritt aktualisieren
            updateProgressView();
            
            // Erfolgsbenachrichtigung anzeigen
            const successMsg = document.getElementById('daily-success');
            successMsg.style.display = 'block';
            
            // Nach 3 Sekunden ausblenden
            setTimeout(() => {
                successMsg.style.display = 'none';
                
                // Formular zurücksetzen
                document.querySelectorAll('#daily-challenges input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                document.getElementById('daily-note').value = '';
                selectedMood = 0;
                document.querySelectorAll('.mood-option').forEach(option => {
                    option.classList.remove('selected');
                });
            }, 3000);
        }
        
        // Einträge laden und anzeigen
        function loadLogEntries() {
            const savedEntries = localStorage.getItem('dailyEntries');
            const entriesDiv = document.getElementById('log-entries');
            entriesDiv.innerHTML = '';
            
            if (savedEntries) {
                const entries = JSON.parse(savedEntries);
                
                // Nach Datum sortieren (neueste zuerst)
                entries.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                entries.forEach(entry => {
                    const entryElement = document.createElement('div');
                    entryElement.className = 'log-entry';
                    
                    // Datum formatieren
                    const date = new Date(entry.date);
                    const formattedDate = date.toLocaleDateString('de-DE', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                    
                    // Stimmung-Emoji
                    const moodEmojis = ['', '😢', '😕', '😐', '🙂', '😄'];
                    
                    entryElement.innerHTML = `
                        <div class="log-date">${formattedDate}</div>
                        <div class="log-mood">Stimmung: ${moodEmojis[entry.mood]}</div>
                        <div class="log-challenges">
                            <strong>Geschafft:</strong>
                            ${entry.completedChallenges.length > 0 
                              ? entry.completedChallenges.map(c => `<div>✓ ${c.label}</div>`).join('') 
                              : '<div>Keine Challenges erledigt</div>'}
                        </div>
                        ${entry.note ? `<div class="log-note">${entry.note}</div>` : ''}
                    `;
                    
                    entriesDiv.appendChild(entryElement);
                });
            } else {
                entriesDiv.innerHTML = '<p>Noch keine Einträge vorhanden. Starte mit deinem ersten Check-in!</p>';
            }
        }
        
        // Tag als erledigt markieren/demarkieren im Fortschritts-Tracker
        function toggleDay(dayNumber) {
            // Tag finden
            const dayElement = document.querySelector(`.day:nth-child(${dayNumber})`);
            
            // Zustand umschalten
            if (dayElement.classList.contains('completed')) {
                dayElement.classList.remove('completed');
                completedDays = completedDays.filter(day => day !== dayNumber);
            } else {
                dayElement.classList.add('completed');
                if (!completedDays.includes(dayNumber)) {
                    completedDays.push(dayNumber);
                }
            }
            
            // Fortschrittsbalken aktualisieren
            updateProgress();
        }
        
        // Fortschrittsansicht aktualisieren
        function updateProgressView() {
            // Tage laden, die als erledigt markiert wurden
            const savedEntries = localStorage.getItem('dailyEntries');
            completedDays = [];
            
            if (savedEntries) {
                const entries = JSON.parse(savedEntries);
                completedDays = entries.filter(entry => entry.completedChallenges.length > 0)
                                       .map((entry, index) => index + 1)
                                       .slice(0, 7);
            }
            
            // Tage im UI markieren
            document.querySelectorAll('.day').forEach((day, index) => {
                if (completedDays.includes(index + 1)) {
                    day.classList.add('completed');
                } else {
                    day.classList.remove('completed');
                }
            });
            
            // Fortschrittsbalken aktualisieren
            updateProgress();
            
            // Stimmungsverlauf anzeigen
            updateMoodChart();
        }
        
        // Fortschrittsbalken aktualisieren
        function updateProgress() {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            const completedCount = completedDays.length;
            const percent = (completedCount / 7) * 100;
            
            progressBar.style.width = `${percent}%`;
            progressText.innerText = `Du hast bisher ${completedCount} von 7 Tagen geschafft`;
            
            // Hervorheben, wenn Ziel erreicht
            if (completedCount >= 5) {
                progressBar.style.backgroundColor = '#66bb6a';
                progressText.innerHTML = `<strong>Glückwunsch!</strong> Du hast dein Ziel erreicht (${completedCount}/7 Tage)`;
            } else {
                progressBar.style.backgroundColor = 'var(--primary)';
            }
        }
        
        // Stimmungsverlauf anzeigen
        function updateMoodChart() {
            const chartDiv = document.getElementById('mood-chart');
            chartDiv.innerHTML = '';
            
            const savedEntries = localStorage.getItem('dailyEntries');
            if (!savedEntries) return;
            
            const entries = JSON.parse(savedEntries);
            if (entries.length === 0) return;
            
            // Nach Datum sortieren (älteste zuerst)
            entries.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Nur die ersten 7 Einträge anzeigen
            const displayEntries = entries.slice(0, 7);
            
            // Balken für jeden Tag erstellen
            displayEntries.forEach((entry, index) => {
                const moodEmojis = ['', '😢', '😕', '😐', '🙂', '😄'];
                const barHeight = entry.mood * 20; // Höhe basierend auf Stimmung (1-5)
                
                const bar = document.createElement('div');
                bar.style.width = `${100 / Math.min(7, displayEntries.length)}%`;
                bar.style.height = `${barHeight}px`;
                bar.style.backgroundColor = 'var(--primary)';
                bar.style.marginRight = '5px';
                bar.style.position = 'relative';
                bar.style.borderRadius = '3px 3px 0 0';
                
                const emoji = document.createElement('div');
                emoji.style.position = 'absolute';
                emoji.style.top = '-25px';
                emoji.style.width = '100%';
                emoji.style.textAlign = 'center';
                emoji.innerText = moodEmojis[entry.mood];
                
                const day = document.createElement('div');
                day.style.position = 'absolute';
                day.style.bottom = '-20px';
                day.style.width = '100%';
                day.style.textAlign = 'center';
                day.style.fontSize = '12px';
                
                // Datum in kurzes Format umwandeln
                const date = new Date(entry.date);
                day.innerText = date.toLocaleDateString('de-DE', {day: '2-digit', month: '2-digit'});
                
                bar.appendChild(emoji);
                bar.appendChild(day);
                chartDiv.appendChild(bar);
            });
        }
        
        // Reflektionen speichern
        function saveReflections() {
            const reflections = document.getElementById('reflections').value;
            localStorage.setItem('reflections', reflections);
        }
    </script>
<script>

// Funktion zum Teilen des Tagesberichts

function shareDaily() {

// Aktuelle Eingaben abrufen

const date = document.getElementById('log-date').value;

let moodText = "";


// Stimmungs-Emoji ermitteln

if(selectedMood > 0) {

const moodEmojis = ['', '😢', '😕', '😐', '🙂', '😄'];

moodText = moodEmojis[selectedMood];

}


// Erledigte Challenges sammeln

let completedText = "";

document.querySelectorAll('#daily-challenges input[type="checkbox"]').forEach(checkbox => {

if (checkbox.checked) {

completedText += "✓ " + checkbox.nextElementSibling.innerText + "\n";

}

});


if(!completedText) {

completedText = "Heute keine Challenges abgeschlossen";

}


// Notiz abrufen

const note = document.getElementById('daily-note').value;


// Zusammenfassung erstellen

const summary = `📊 MEIN 7-TAGE-CHALLENGE UPDATE

📅 Tag: ${new Date(date).toLocaleDateString('de-DE')}

${moodText} Stimmung: ${selectedMood}/5

GESCHAFFTE CHALLENGES:

${completedText}

${note ? `💭 NOTIZ:\n${note}` : ''}`;


// Text in Zwischenablage kopieren (für Mobilgeräte)

if (navigator.clipboard && navigator.clipboard.writeText) {

navigator.clipboard.writeText(summary)

.then(() => {

alert("Bericht wurde in die Zwischenablage kopiert! Du kannst ihn jetzt in WhatsApp einfügen.");


// Auf Mobilgeräten WhatsApp öffnen, falls möglich

if(/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {

if (confirm("WhatsApp öffnen, um den Bericht zu teilen?")) {

window.open("https://wa.me/?text=" + encodeURIComponent(summary));

}

}

})

.catch(err => {

alert("Fehler beim Kopieren: " + err);

});

} else {

// Fallback für ältere Browser

const textarea = document.createElement('textarea');

textarea.value = summary;

document.body.appendChild(textarea);

textarea.select();

document.execCommand('copy');

document.body.removeChild(textarea);

alert("Bericht wurde in die Zwischenablage kopiert! Du kannst ihn jetzt in WhatsApp einfügen.");

}

}

// Teilen-Button zum täglichen Check-in Tab hinzufügen

document.addEventListener('DOMContentLoaded', function() {

// Erstelle den Button

const shareButton = document.createElement('button');

shareButton.innerHTML = '📱 Bericht an Coach senden';

shareButton.style.marginTop = '20px';

shareButton.style.backgroundColor = '#4caf50';

shareButton.onclick = shareDaily;


// Füge den Button nach dem "Eintrag speichern" Button ein

const saveButton = document.querySelector('#daily button');

saveButton.parentNode.insertBefore(shareButton, saveButton.nextSibling);

});

</script>
</body>
</html>